<!DOCTYPE html>
<html lang="en">
<!--WorkSlate, QuickSlate and Maths Master - TERMS OF USE AND COPYRIGHT NOTICE
============================================================================
Copyright (c) 2025 Andrew Wilkins (Maths Master, WorkSlate, and QuickSlate). All rights reserved.

This document outlines the terms of use for the "WorkSlate" and "QuickSlate" applications
and the "Maths Master Hub" dashboard.

1. OWNERSHIP
----------------------------------------------------------------------------
All source code, interface designs, custom graphics (including the Maths
Master logo), and logical implementations (widgets, canvas tools, draggables)
are the sole intellectual property of Andrew Wilkins.

2. PERMITTED USE
----------------------------------------------------------------------------
- Educational Use: Teachers, students, and educational institutions are
  granted a non-exclusive license to use this software for teaching and
  learning purposes.
- Personal Use: Individuals may use this software for personal organization
  or study.

3. RESTRICTIONS & PROHIBITIONS
----------------------------------------------------------------------------
- Commercial Use: You may NOT sell, rent, lease, or sublicense this software
  or any part of its source code.
- Redistribution: You may NOT redistribute this code, in whole or in part,
  on any public repository or server claiming it as your own work.
- Branding: You may NOT remove, obscure, or alter the "designed by Andy"
  attribution or copyright notices embedded in the application.

4. DISCLAIMER
----------------------------------------------------------------------------
This software is provided "as is", without warranty of any kind, express or
implied. The copyright holder (Andre Wilkins) shall not be liable for any damages,
data loss, or issues arising from the use of this software.

============================================================================
Contact: andyrwilkins123@gmail.com -->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Work Slate</title>

    <!-- External Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600&family=Caveat:wght@400;700&family=Chewy&family=Covered+By+Your+Grace&family=Gloria+Hallelujah&family=Kalam:wght@300;400;700&family=Patrick+Hand&family=Permanent+Marker&family=Rock+Salt&display=swap" rel="stylesheet">

    <!-- External CSS -->
    <link rel="stylesheet" href="styles.css">

    <!-- MathJax Configuration -->
    <script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']]
        },
        svg: { fontCache: 'global' }
    };
    </script>

    <!-- External Libraries -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
</head>
<body>
    <div class="brand-float">
        <div class="logo-text">Work<span>Slate</span></div>
        <div class="by-andy">designed by Andy</div>
    </div>
<div class="main-container">

    <div class="canvas-stack" id="canvas-wrapper">
        <canvas id="bgCanvas"></canvas>
        <canvas id="mainCanvas"></canvas>
        <canvas id="tempCanvas"></canvas>
        </div>
    </div>
    <aside class="inspector" id="mainInspector" style="display:none;">
    <div class="inspector-content">

        <section id="panel-pen" class="inspector-box" style="display:none;">
            <div class="section-title">Stroke & Line</div>

            <label style="font-size:11px; font-weight:700; color:#64748b; margin-bottom:4px; display:block;">Thickness</label>
            <select id="rangeThickness" onchange="app.setPenSize(this.value)" style="width:100%; padding:6px; border-radius:6px; border:1px solid #cbd5e1; margin-bottom:8px; background:white;">
                <option value="1">1px (Fine)</option>
                <option value="2">2px</option>
                <option value="3">3px (Standard)</option>
                <option value="5">5px (Medium)</option>
                <option value="8">8px</option>
                <option value="10">10px (Thick)</option>
                <option value="15">15px</option>
                <option value="20">20px (Marker)</option>
                <option value="30">30px (Huge)</option>
            </select>

            <div id="penTypeControl" style="margin-bottom:8px;">
                <label style="font-size:11px; font-weight:700; color:#64748b; margin-bottom:4px; display:block;">Style</label>
                <select onchange="app.setPenType(this.value)" style="width: 100%; padding:6px; border-radius:6px; border:1px solid #cbd5e1; background:white;">
                    <option value="pen">Standard Pen</option>
                    <option value="brush">Brush</option>
                    <option value="highlighter">Highlighter</option>
                </select>
            </div>
        </section>

        <section id="panel-text" class="inspector-box" style="display:none;">
            <div class="section-title">Typography</div>

            <div style="margin-bottom:8px;">
                <label style="font-size:11px; font-weight:700; color:#64748b; margin-bottom:4px; display:block;">Font Family</label>
                <select id="fontSelect" onchange="app.setFontFamily(this.value)" style="width: 100%; padding:6px; border-radius:6px; border:1px solid #cbd5e1; background:white;">
                    <option value="'Lexend', sans-serif">Lexend (Clean)</option>
                    <option value="'Comic Sans MS', 'Comic Sans', cursive">Comic Sans (Fun)</option>
                    <option value="'Times New Roman', serif">Times (Formal)</option>
                    <option value="'Courier New', monospace">Courier (Code)</option>
                    <option value="'Permanent Marker'">Marker (Bold)</option>
                </select>
            </div>

            <div style="margin-bottom:8px;">
                <label style="font-size:11px; font-weight:700; color:#64748b; margin-bottom:4px; display:block;">Size</label>
                <select id="rangeTextSize" onchange="app.setTextSize(this.value)" style="width:100%; padding:6px; border-radius:6px; border:1px solid #cbd5e1; background:white;">
                    <option value="12">12pt (Small)</option>
                    <option value="16">16pt</option>
                    <option value="20">20pt</option>
                    <option value="24">24pt</option>
                    <option value="36">36pt (Normal)</option>
                    <option value="48">48pt</option>
                    <option value="64">64pt (Heading)</option>
                    <option value="72">72pt (Large)</option>
                    <option value="96">96pt (Huge)</option>
                </select>
            </div>

            <div style="display:flex; gap:4px;">
                <button class="btn" onclick="app.toggleTextBold()" style="flex:1;"><b>B</b></button>
                <button class="btn" onclick="app.toggleTextItalic()" style="flex:1;"><i>I</i></button>
            </div>
        </section>

        <section id="panel-color" class="inspector-box" style="display:none;">
            <div class="section-title">Color</div>
            <div class="color-grid">
                <div class="swatch" style="background:#000000;" onclick="app.setColor('#000000')"></div>
                <div class="swatch" style="background:#ef4444;" onclick="app.setColor('#ef4444')"></div>
                <div class="swatch" style="background:#3b82f6;" onclick="app.setColor('#3b82f6')"></div>
                <div class="swatch" style="background:#10b981;" onclick="app.setColor('#10b981')"></div>
                <div class="swatch" style="background:#f59e0b;" onclick="app.setColor('#f59e0b')"></div>
                <div class="swatch" style="background:#8b5cf6;" onclick="app.setColor('#8b5cf6')"></div>
                <div class="swatch" style="background:#ffffff; border:2px solid #cbd5e1;" onclick="app.setColor('#ffffff')"></div>
                <div class="swatch" style="background:conic-gradient(red, yellow, lime, cyan, blue, magenta, red);" onclick="document.getElementById('colorPicker').click()"></div>
            </div>
        </section>

    </div>
</aside>
<div class="dock-container">
    <div class="icon-btn" onclick="app.undo()" title="Undo">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 7v6h6"></path><path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"></path></svg>
    </div>
    <div class="icon-btn" onclick="app.redo()" title="Redo">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 7v6h-6"></path><path d="M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7"></path></svg>
    </div>

    <div class="dock-divider"></div>

    <div class="icon-btn active" onclick="app.setTool('select')" title="Select">
        <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z"></path></svg>
    </div>
    <div class="icon-btn" onclick="app.setTool('pen')" title="Pen">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg>
    </div>
    <div class="icon-btn" onclick="app.setTool('eraser')" title="Eraser">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M20 20H7L3 16C3 16 3 16 3 16C1.5 14.5 1.5 12 3 10.5L10 3.5C11.5 2 14 2 15.5 3.5L20.5 8.5C22 10 22 12.5 20.5 14L16 18.5"></path>
        <path d="M18 14l-6-6"></path>
    </svg>
</div>

    <div class="dock-divider"></div>

    <div class="icon-btn" onclick="app.setTool('rect')" title="Square">
        <div style="width:14px; height:14px; border:2px solid currentColor; border-radius:2px;"></div>
    </div>
    <div class="icon-btn" onclick="app.setTool('circle')" title="Circle">
        <div style="width:14px; height:14px; border:2px solid currentColor; border-radius:50%;"></div>
    </div>
    <div class="icon-btn" onclick="app.setTool('poly')" title="Polygon">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2l8.66 5v10L12 22l-8.66-5V7L12 2z"></path></svg>
    </div>
    <div class="icon-btn" onclick="app.setTool('line')" title="Line">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="5" y1="19" x2="19" y2="5"></line>
    </svg>
</div>
    <div class="icon-btn" onclick="app.setTool('text')" title="Text">
        <span style="font-weight:700; font-family:serif; font-size:18px;">T</span>
    </div>
   <div class="icon-btn" onclick="document.getElementById('fileInput').click()" title="Image">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
        <circle cx="8.5" cy="8.5" r="1.5"></circle>
        <polyline points="21 15 16 10 5 21"></polyline>
    </svg>
</div>

    <div class="dock-divider"></div>

    <div class="icon-btn" onclick="app.toggleRuler()" title="Ruler">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="2" y="8" width="20" height="8" rx="1"></rect>
            <path d="M6 8v3"></path>
            <path d="M10 8v3"></path>
            <path d="M14 8v3"></path>
            <path d="M18 8v3"></path>
        </svg>
    </div>
    <div class="icon-btn" onclick="app.toggleProtractor()" title="Protractor">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19a8 8 0 0 1 16 0"></path><path d="M12 19v-2"></path></svg>
    </div>
    <div class="icon-btn" onclick="app.toggleCompass()" title="Compass">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="2"></circle><path d="M12 7l-7 15 M12 7l7 15 M8.5 14h7"></path></svg>
    </div>
    <div class="icon-btn" onclick="app.physics.toggle()" id="dockBtnGravity" title="Gravity">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 20.94c1.5 0 2.75 1.06 4 1.06 3 0 6-8 6-12.22A4.91 4.91 0 0 0 17 5c-2.22 0-4 1.44-5 2-1-.56-2.78-2-5-2a4.9 4.9 0 0 0-5 4.78C2 14 5 22 8 22c1.25 0 2.5-1.06 4-1.06Z"></path>
            <path d="M10 2c1 .5 2 2 2 5"></path>
        </svg>
    </div>
    <div class="icon-btn" onclick="ui.toggleWindow('win-calc')" title="Calculator">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="4" y="2" width="16" height="20" rx="2"></rect>
            <line x1="8" y1="6" x2="16" y2="6"></line>
            <path d="M8 10h.01"></path><path d="M12 10h.01"></path><path d="M16 10h.01"></path>
            <path d="M8 14h.01"></path><path d="M12 14h.01"></path><path d="M16 14h.01"></path>
            <path d="M8 18h.01"></path><path d="M12 18h.01"></path><path d="M16 18h.01"></path>
        </svg>
    </div>

    <div class="dock-divider"></div>

    <div class="icon-btn" onclick="ui.toggleWindow('win-bg')" title="Background">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"></rect><path d="M3 9h18 M3 15h18 M9 3v18 M15 3v18"></path></svg>
    </div>
    <div class="icon-btn" onclick="ui.toggleWindow('win-dice')" title="Dice Roller">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><circle cx="15.5" cy="15.5" r="1.5"></circle></svg>
    </div>
    <div class="icon-btn" onclick="ui.toggleWindow('win-timer')" title="Timer">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
    </div>
    <div class="icon-btn" onclick="ui.toggleWindow('win-yt')" title="YouTube">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
    </div>
    <div class="icon-btn" onclick="toggleChat()" title="AI Tutor">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M9 22C9 17 5 13 1 13C5 13 9 9 9 4C9 9 13 13 17 13C13 13 9 17 9 22Z"></path>
            <path d="M20 3L22.5 6L20 9L17.5 6L20 3Z"></path>
        </svg>
    </div>
    <div class="icon-btn" id="btn-radial-toggle" onclick="radialMenu.toggle()" title="Toggle Right-Click Menu">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M12 8v8"></path>
            <path d="M8 12h8"></path>
        </svg>
    </div>

    <div class="dock-divider"></div>

    <div class="icon-btn" onclick="app.toggleSorter()" title="Slide Sorter">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>
    </div>
    <div class="icon-btn" onclick="app.prevSlide()">
        <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 18l-6-6 6-6"></path></svg>
    </div>
    <div class="icon-btn" onclick="app.nextSlide()">
        <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"></path></svg>
    </div>

    <div class="icon-btn" onclick="app.openProject()" title="Open Project">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>
    </div>
    <div class="icon-btn" onclick="app.saveProject()" title="Save">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
        <polyline points="17 21 17 13 7 13 7 21"></polyline>
        <polyline points="7 3 7 8 15 8"></polyline>
    </svg>
</div>
    <div class="icon-btn" onclick="app.saveProjectAs()" title="Save As...">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v3.5"></path>

        <polyline points="7 3 7 8 15 8"></polyline>

        <path d="M7 21v-8h6"></path>

        <path d="M19 14v8"></path>
        <path d="M15 18h8"></path>
    </svg>
</div>
    <div class="icon-btn" onclick="app.exportPNG()" title="Export PNG">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
    </div>
</div>



<textarea id="textEditor"></textarea>
    <div id="textToolbar" class="text-toolbar" style="display:none;">
    <button class="tt-btn" onclick="app.toggleTextBold()" title="Bold"><strong>B</strong></button>
    <button class="tt-btn" onclick="app.toggleTextItalic()" title="Italic"><em>I</em></button>
    <div class="tt-sep"></div>
    <input type="color" id="textToolbarColor" oninput="app.updateTextColor(this.value)" title="Text Color">
</div>
    <div id="slideSorter">
    <div class="add-slide-card" onclick="app.addSlide()">
        <span style="font-size:40px;">+</span>
        <span>New Slide</span>
    </div>
</div>

<div id="win-calc" class="floating-window"
     style="width: 360px; height: 600px; max-height: 85vh; display: none; flex-direction: column;
            resize: both; overflow: hidden; min-width: 300px; min-height: 400px;">

    <div class="fw-header" style="display: flex; align-items: center; justify-content: space-between;">
        <span>Calculator</span>

        <div style="display: flex; gap: 5px; background: rgba(0,0,0,0.05); padding: 2px; border-radius: 8px;">
            <button id="btn-mode-sci" onclick="switchCalcMode('sci')" style="border: none; background: white; padding: 2px 8px; border-radius: 6px; font-size: 11px; font-weight: bold; cursor: pointer; box-shadow: 0 1px 2px rgba(0,0,0,0.1);">Sci</button>
            <button id="btn-mode-graph" onclick="switchCalcMode('graph')" style="border: none; background: transparent; padding: 2px 8px; border-radius: 6px; font-size: 11px; font-weight: bold; cursor: pointer; color: #64748b;">Graph</button>
        </div>

        <span class="fw-close" onclick="ui.toggleWindow('win-calc')">&times;</span>
    </div>

    <div class="fw-content" style="padding: 0; flex-grow: 1; overflow: hidden; background: white; position: relative;">
        <iframe id="desmos-frame" src="https://www.desmos.com/scientific" width="100%" height="100%" style="border:none;"></iframe>

        <div style="position: absolute; bottom: 2px; right: 2px; pointer-events: none; opacity: 0.5;">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#94a3b8" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                <line x1="21" y1="21" x2="12" y2="21"></line>
                <line x1="21" y1="12" x2="21" y2="21"></line>
                <line x1="16" y1="21" x2="21" y2="16"></line>
            </svg>
        </div>
    </div>

    <script>
        function switchCalcMode(mode) {
            const frame = document.getElementById('desmos-frame');
            const btnSci = document.getElementById('btn-mode-sci');
            const btnGraph = document.getElementById('btn-mode-graph');
            const win = document.getElementById('win-calc');

            if (mode === 'sci') {
                frame.src = "https://www.desmos.com/scientific";
                win.style.width = "360px";

                // Style Buttons
                btnSci.style.background = "white"; btnSci.style.boxShadow = "0 1px 2px rgba(0,0,0,0.1)"; btnSci.style.color = "black";
                btnGraph.style.background = "transparent"; btnGraph.style.boxShadow = "none"; btnGraph.style.color = "#64748b";
            } else {
                frame.src = "https://www.desmos.com/calculator?embedded=true";
                win.style.width = "600px";

                // Style Buttons
                btnGraph.style.background = "white"; btnGraph.style.boxShadow = "0 1px 2px rgba(0,0,0,0.1)"; btnGraph.style.color = "black";
                btnSci.style.background = "transparent"; btnSci.style.boxShadow = "none"; btnSci.style.color = "#64748b";
            }

            // Keep on screen if expansion pushes it off
            if(parseInt(win.style.left) + parseInt(win.style.width) > window.innerWidth) {
                win.style.left = (window.innerWidth - parseInt(win.style.width) - 20) + "px";
            }
        }
    </script>
</div>
    <div id="win-bg" class="floating-window" style="width: 250px;">
    <div class="fw-header">Background <span class="fw-close" onclick="ui.toggleWindow('win-bg')">&times;</span></div>
    <div class="fw-content">
        <label style="font-size:12px; font-weight:bold; color:#64748b; display:block; margin-bottom:4px;">Grid Type</label>
        <select id="bgSelect" onchange="app.setGridType(this.value)" style="width:100%; padding:6px; border-radius:6px; border:1px solid #cbd5e1; margin-bottom:10px;">
            <option value="square" selected>Squares</option>
            <option value="graph-cyan">Cyan Graph</option>
            <option value="lined">Lined</option>
            <option value="dot">Dots</option>
            <option value="none">Blank</option>
            <option value="webcam">üì∑ Webcam (AR)</option>
        </select>

        <button id="btnFreeze" class="btn" onclick="app.toggleWebcamFreeze()" style="display:none; width:100%; margin-bottom:10px; background:#fee2e2; color:#ef4444; border-color:#fca5a5;">
            ‚ùÑ Freeze Frame
        </button>

        <label style="font-size:12px; font-weight:bold; color:#64748b; display:block; margin-bottom:4px;">Grid Size</label>
        <input type="range" min="20" max="100" value="50" oninput="app.setGridSize(this.value)" style="width:100%; margin-bottom:10px;">

        <label style="font-size:12px; font-weight:bold; color:#334155; display:flex; align-items:center; gap:8px;">
            <input type="checkbox" id="chkSnap" onchange="app.toggleSnap()"> Snap to Grid
        </label>
    </div>
</div>

<div id="win-dice" class="floating-window">
    <div class="fw-header">Dice Roller <span class="fw-close" onclick="ui.toggleWindow('win-dice')">&times;</span></div>
    <div class="fw-content" style="text-align:center;">
        <div style="margin-bottom:15px;">
            <input type="number" id="diceCount" value="2" min="1" max="6" style="width:50px; padding:4px;">
            <button class="btn" onclick="ui.rollDice()">Roll</button>
        </div>
        <div id="diceContainer" style="display:flex; justify-content:center; gap:10px; flex-wrap:wrap; min-height:60px;"></div>
    </div>
</div>

<div id="win-timer" class="floating-window">
    <div class="fw-header">Timer <span class="fw-close" onclick="ui.toggleWindow('win-timer')">&times;</span></div>
    <div class="fw-content" style="text-align:center;">
        <div id="timerDisplay" style="font-size:48px; font-weight:700; font-family:monospace; margin:10px 0;">00:00</div>
        <div style="display:flex; justify-content:center; gap:5px; margin-bottom:15px;">
            <input type="number" id="tMin" placeholder="Min" style="width:50px; padding:4px;">
            <input type="number" id="tSec" placeholder="Sec" style="width:50px; padding:4px;">
        </div>
        <div style="display:flex; gap:10px; justify-content:center;">
            <button class="btn" onclick="ui.startTimer()">Start</button>
            <button class="btn" onclick="ui.stopTimer()">Stop</button>
            <button class="btn" onclick="ui.resetTimer()">Reset</button>
        </div>
    </div>
</div>

<div id="win-yt" class="floating-window" style="width:400px;">
    <div class="fw-header">YouTube Player <span class="fw-close" onclick="ui.toggleWindow('win-yt')">&times;</span></div>
    <div class="fw-content">
        <div style="display:flex; gap:5px; margin-bottom:10px;">
            <input type="text" id="ytUrl" placeholder="Paste YouTube URL here..." style="flex:1; padding:4px;">
            <button class="btn" onclick="ui.loadYoutube()">Load</button>
        </div>
        <iframe id="ytFrame" style="width:100%; height:200px; border:none; background:black;"></iframe>
    </div>
</div>
   <div id="agent-chat-window">
    <div id="agent-header">
        <span>AI Tutor Assistant</span>
        <button onclick="toggleChat()"
                style="background:none; border:none; color:#ef4444; font-size:28px; font-weight:bold; cursor:pointer; line-height:1;"
                onmouseover="this.style.transform='scale(1.2)'"
                onmouseout="this.style.transform='scale(1)'">
            &times;
        </button>
    </div>

    <div id="agent-level-select">
        <button class="lvl-btn active" onclick="setAILevel('KS1')">KS1</button>
        <button class="lvl-btn" onclick="setAILevel('KS2')">KS2</button>
        <button class="lvl-btn" onclick="setAILevel('KS3')">KS3</button>
        <button class="lvl-btn" onclick="setAILevel('KS4')">KS4</button>
        <button class="lvl-btn" onclick="setAILevel('KS5')">KS5</button>
    </div>

    <div id="agent-messages">
        <div class="message bot-message">Hello! Select a Key Stage above and ask me anything!</div>
    </div>
    <div id="agent-input-area">
        <input type="text" id="agent-input" placeholder="Type your question..." onkeypress="handleEnter(event)">
        <button onclick="sendMessage()" style="background:#1a2a6c; color:white; border:none; width:45px; height:40px; border-radius:6px; cursor:pointer;">‚û§</button>
    </div>
</div>
<div id="radialOverlay" class="radial-overlay" onclick="radialMenu.hide()">
    <div id="radialMenu" class="radial-menu">
        <div class="radial-btn radial-center" onclick="radialMenu.hide()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
        </div>

        </div>
</div>
    <input type="color" id="colorPicker" style="display:none;" oninput="app.setColor(this.value)">
    <input type="file" id="fileInput" accept="image/*" style="display:none;">
    <input type="file" id="loadInput" accept=".json" onchange="app.loadProjectFile(this)" style="display:none;">

    <!-- Main Application Scripts -->
    <script src="script.js"></script>
    <script src="script_mathsmaster.js"></script>
</body>
</html>
